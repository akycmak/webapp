<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–µ—Å—Ç—Ä –º–æ–Ω–µ—Ç (–ê–¥–º–∏–Ω)</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            padding: 16px;
            padding-bottom: 80px;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--tg-theme-hint-color, #ccc);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--tg-theme-button-color, #3390ec);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .action-btn {
            padding: 12px;
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .action-btn.secondary {
            background: var(--tg-theme-secondary-bg-color, #e0e0e0);
            color: var(--tg-theme-text-color, #000000);
        }

        .coin-card {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .coin-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .coin-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .coin-icon {
            font-size: 32px;
        }

        .coin-info h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .coin-symbol {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999);
        }

        .coin-toggle {
            width: 50px;
            height: 28px;
            background: #ccc;
            border-radius: 14px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .coin-toggle.active {
            background: #34c759;
        }

        .coin-toggle::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: left 0.3s;
        }

        .coin-toggle.active::after {
            left: 24px;
        }

        .coin-details {
            display: grid;
            gap: 8px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: var(--tg-theme-bg-color, #ffffff);
            border-radius: 6px;
            font-size: 13px;
        }

        .detail-label {
            color: var(--tg-theme-hint-color, #999);
            font-weight: 500;
        }

        .detail-value {
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .coin-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .coin-action-btn {
            flex: 1;
            padding: 8px;
            background: var(--tg-theme-bg-color, #ffffff);
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            color: var(--tg-theme-text-color, #000000);
        }

        .coin-action-btn.danger {
            color: #ff3b30;
            border-color: #ff3b30;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            padding: 16px;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--tg-theme-bg-color, #ffffff);
            border-radius: 16px;
            padding: 24px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--tg-theme-hint-color, #999);
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            border-radius: 8px;
            font-size: 15px;
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #000000);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--tg-theme-button-color, #3390ec);
        }

        .form-select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            border-radius: 8px;
            font-size: 15px;
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #000000);
        }

        .modal-buttons {
            display: flex;
            gap: 8px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
        }

        .modal-btn-primary {
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
        }

        .modal-btn-secondary {
            background: var(--tg-theme-secondary-bg-color, #e0e0e0);
            color: var(--tg-theme-text-color, #000000);
        }

        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 2000;
        }

        .toast.show {
            opacity: 1;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge-bip39 {
            background: #34c759;
            color: white;
        }

        .badge-ton {
            background: #0098ea;
            color: white;
        }

        .badge-electrum {
            background: #ff9500;
            color: white;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚öôÔ∏è –†–µ–µ—Å—Ç—Ä –º–æ–Ω–µ—Ç</h1>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º–∏ –¥–ª—è –¥–µ—Ä–∏–≤–∞—Ü–∏–∏</p>
    </div>

    <div class="stats">
        <div class="stat-card">
            <div class="stat-value" id="totalCoins">0</div>
            <div class="stat-label">–í—Å–µ–≥–æ –º–æ–Ω–µ—Ç</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="activeCoins">0</div>
            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="inactiveCoins">0</div>
            <div class="stat-label">–û—Ç–∫–ª—é—á–µ–Ω—ã</div>
        </div>
    </div>

    <div class="action-buttons">
        <button class="action-btn" onclick="openAddModal()">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—É
        </button>
        <button class="action-btn secondary" onclick="resetToDefaults()">
            üîÑ –°–±—Ä–æ—Å–∏—Ç—å
        </button>
    </div>

    <div id="coinsContainer"></div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="modal" id="coinModal">
        <div class="modal-content">
            <div class="modal-header" id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—É</div>
            
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input type="text" class="form-input" id="coinName" placeholder="Bitcoin">
            </div>

            <div class="form-group">
                <label class="form-label">–°–∏–º–≤–æ–ª</label>
                <input type="text" class="form-input" id="coinSymbol" placeholder="BTC">
            </div>

            <div class="form-group">
                <label class="form-label">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏)</label>
                <input type="text" class="form-input" id="coinIcon" placeholder="‚Çø">
            </div>

            <div class="form-group">
                <label class="form-label">–¢–∏–ø</label>
                <select class="form-select" id="coinType" onchange="updatePathVisibility()">
                    <option value="BIP39">BIP39 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)</option>
                    <option value="TON">TON (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π)</option>
                    <option value="ELECTRUM">Electrum</option>
                </select>
            </div>

            <div class="form-group" id="pathGroup">
                <label class="form-label">–î–µ—Ä–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—É—Ç—å</label>
                <input type="text" class="form-input" id="coinPath" placeholder="m/44'/0'/0'/0">
            </div>

            <div class="modal-buttons">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="modal-btn modal-btn-primary" onclick="saveCoin()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è');
        tg.MainButton.show();
        tg.BackButton.show();
        tg.BackButton.onClick(() => tg.close());

        // –ë–∞–∑–æ–≤—ã–π —Ä–µ–µ—Å—Ç—Ä –º–æ–Ω–µ—Ç (30+ –º–æ–Ω–µ—Ç)
        let coinsRegistry = [
            // Bitcoin
            { id: 'btc', name: 'Bitcoin', symbol: 'BTC', type: 'BIP39', path: "m/44'/0'/0'/0", icon: '‚Çø', active: true },
            { id: 'btc_segwit', name: 'Bitcoin SegWit', symbol: 'BTC', type: 'BIP39', path: "m/49'/0'/0'/0", icon: '‚Çø', active: true },
            { id: 'btc_native', name: 'Bitcoin Native SegWit', symbol: 'BTC', type: 'BIP39', path: "m/84'/0'/0'/0", icon: '‚Çø', active: true },
            { id: 'ltc', name: 'Litecoin', symbol: 'LTC', type: 'BIP39', path: "m/44'/2'/0'/0", icon: '≈Å', active: true },
            { id: 'bch', name: 'Bitcoin Cash', symbol: 'BCH', type: 'BIP39', path: "m/44'/145'/0'/0", icon: 'üíö', active: true },
            { id: 'doge', name: 'Dogecoin', symbol: 'DOGE', type: 'BIP39', path: "m/44'/3'/0'/0", icon: 'üêï', active: true },
            { id: 'dash', name: 'Dash', symbol: 'DASH', type: 'BIP39', path: "m/44'/5'/0'/0", icon: 'üí≥', active: false },
            
            // Ethereum / EVM
            { id: 'eth', name: 'Ethereum', symbol: 'ETH', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'Œû', active: true },
            { id: 'usdt_erc20', name: 'Tether ERC-20', symbol: 'USDT', type: 'BIP39', path: "m/44'/60'/0'/0", icon: '‚ÇÆ', active: true },
            { id: 'usdc_erc20', name: 'USD Coin ERC-20', symbol: 'USDC', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üíµ', active: true },
            { id: 'bnb', name: 'BNB Chain', symbol: 'BNB', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üî∂', active: true },
            { id: 'matic', name: 'Polygon', symbol: 'MATIC', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üü£', active: true },
            { id: 'avax', name: 'Avalanche C-Chain', symbol: 'AVAX', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üî∫', active: true },
            { id: 'ftm', name: 'Fantom', symbol: 'FTM', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üëª', active: false },
            { id: 'arb', name: 'Arbitrum', symbol: 'ARB', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üî∑', active: true },
            { id: 'op', name: 'Optimism', symbol: 'OP', type: 'BIP39', path: "m/44'/60'/0'/0", icon: 'üî¥', active: true },
            
            // Altcoins
            { id: 'trx', name: 'Tron', symbol: 'TRX', type: 'BIP39', path: "m/44'/195'/0'/0", icon: '‚ö°', active: true },
            { id: 'usdt_trc20', name: 'Tether TRC-20', symbol: 'USDT', type: 'BIP39', path: "m/44'/195'/0'/0", icon: '‚ÇÆ', active: true },
            { id: 'ada', name: 'Cardano', symbol: 'ADA', type: 'BIP39', path: "m/1852'/1815'/0'/0/0", icon: 'üîµ', active: true },
            { id: 'xrp', name: 'Ripple', symbol: 'XRP', type: 'BIP39', path: "m/44'/144'/0'/0", icon: 'üíß', active: true },
            { id: 'xlm', name: 'Stellar', symbol: 'XLM', type: 'BIP39', path: "m/44'/148'/0'/0", icon: '‚≠ê', active: false },
            { id: 'sol', name: 'Solana', symbol: 'SOL', type: 'BIP39', path: "m/44'/501'/0'/0", icon: '‚óé', active: true },
            { id: 'atom', name: 'Cosmos', symbol: 'ATOM', type: 'BIP39', path: "m/44'/118'/0'/0", icon: '‚öõÔ∏è', active: false },
            { id: 'dot', name: 'Polkadot', symbol: 'DOT', type: 'BIP39', path: "m/44'/354'/0'/0", icon: 'üî¥', active: true },
            { id: 'near', name: 'NEAR Protocol', symbol: 'NEAR', type: 'BIP39', path: "m/44'/397'/0'/0", icon: '‚ìÉ', active: false },
            { id: 'eos', name: 'EOS', symbol: 'EOS', type: 'BIP39', path: "m/44'/194'/0'/0", icon: 'üì°', active: false },
            
            // Other
            { id: 'ton', name: 'TON', symbol: 'TON', type: 'TON', path: null, icon: 'üíé', active: true },
            { id: 'etc', name: 'Ethereum Classic', symbol: 'ETC', type: 'BIP39', path: "m/44'/61'/0'/0", icon: 'üå±', active: false },
            { id: 'zec', name: 'Zcash', symbol: 'ZEC', type: 'BIP39', path: "m/44'/133'/0'/0", icon: 'üõ°Ô∏è', active: false },
            { id: 'xmr', name: 'Monero', symbol: 'XMR', type: 'ELECTRUM', path: null, icon: 'üîí', active: false },
            { id: 'waves', name: 'Waves', symbol: 'WAVES', type: 'BIP39', path: "m/44'/5741564'/0'/0", icon: 'üåä', active: false },
        ];

        let editingCoinId = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            renderCoins();
            updateStats();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–æ–Ω–µ—Ç
        function renderCoins() {
            const container = document.getElementById('coinsContainer');
            
            container.innerHTML = coinsRegistry.map(coin => {
                const badgeClass = coin.type === 'BIP39' ? 'badge-bip39' : coin.type === 'TON' ? 'badge-ton' : 'badge-electrum';
                
                return `
                    <div class="coin-card">
                        <div class="coin-header">
                            <div class="coin-title">
                                <div class="coin-icon">${coin.icon}</div>
                                <div class="coin-info">
                                    <h3>${coin.name} <span class="badge ${badgeClass}">${coin.type}</span></h3>
                                    <div class="coin-symbol">${coin.symbol}</div>
                                </div>
                            </div>
                            <div class="coin-toggle ${coin.active ? 'active' : ''}" onclick="toggleCoin('${coin.id}')"></div>
                        </div>

                        <div class="coin-details">
                            ${coin.path ? `
                            <div class="detail-row">
                                <span class="detail-label">–ü—É—Ç—å –¥–µ—Ä–∏–≤–∞—Ü–∏–∏:</span>
                                <span class="detail-value">${coin.path}</span>
                            </div>
                            ` : `
                            <div class="detail-row">
                                <span class="detail-label">–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:</span>
                                <span class="detail-value">–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç</span>
                            </div>
                            `}
                        </div>

                        <div class="coin-actions">
                            <button class="coin-action-btn" onclick="editCoin('${coin.id}')">
                                ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="coin-action-btn danger" onclick="deleteCoin('${coin.id}')">
                                üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function toggleCoin(coinId) {
            const coin = coinsRegistry.find(c => c.id === coinId);
            if (coin) {
                coin.active = !coin.active;
                renderCoins();
                updateStats();
                showToast(coin.active ? '‚úÖ –ú–æ–Ω–µ—Ç–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞' : '‚ö†Ô∏è –ú–æ–Ω–µ—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞');
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        function editCoin(coinId) {
            editingCoinId = coinId;
            const coin = coinsRegistry.find(c => c.id === coinId);
            
            if (coin) {
                document.getElementById('modalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–µ—Ç—É';
                document.getElementById('coinName').value = coin.name;
                document.getElementById('coinSymbol').value = coin.symbol;
                document.getElementById('coinIcon').value = coin.icon;
                document.getElementById('coinType').value = coin.type;
                document.getElementById('coinPath').value = coin.path || '';
                
                updatePathVisibility();
                document.getElementById('coinModal').classList.add('active');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ
        function deleteCoin(coinId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –º–æ–Ω–µ—Ç—É?')) {
                coinsRegistry = coinsRegistry.filter(c => c.id !== coinId);
                renderCoins();
                updateStats();
                showToast('üóëÔ∏è –ú–æ–Ω–µ—Ç–∞ —É–¥–∞–ª–µ–Ω–∞');
            }
        }

        // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
        function openAddModal() {
            editingCoinId = null;
            document.getElementById('modalTitle').textContent = '–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—É';
            document.getElementById('coinName').value = '';
            document.getElementById('coinSymbol').value = '';
            document.getElementById('coinIcon').value = '';
            document.getElementById('coinType').value = 'BIP39';
            document.getElementById('coinPath').value = '';
            
            updatePathVisibility();
            document.getElementById('coinModal').classList.add('active');
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function closeModal() {
            document.getElementById('coinModal').classList.remove('active');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–æ–ª–µ –ø—É—Ç–∏
        function updatePathVisibility() {
            const type = document.getElementById('coinType').value;
            const pathGroup = document.getElementById('pathGroup');
            
            if (type === 'BIP39') {
                pathGroup.style.display = 'block';
            } else {
                pathGroup.style.display = 'none';
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–Ω–µ—Ç—É
        function saveCoin() {
            const name = document.getElementById('coinName').value.trim();
            const symbol = document.getElementById('coinSymbol').value.trim().toUpperCase();
            const icon = document.getElementById('coinIcon').value.trim();
            const type = document.getElementById('coinType').value;
            const path = document.getElementById('coinPath').value.trim();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!name || !symbol || !icon) {
                showToast('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                return;
            }
            
            if (type === 'BIP39' && !path) {
                showToast('‚ùå –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –¥–µ—Ä–∏–≤–∞—Ü–∏–∏ –¥–ª—è BIP39');
                return;
            }
            
            if (editingCoinId) {
                // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                const coin = coinsRegistry.find(c => c.id === editingCoinId);
                if (coin) {
                    coin.name = name;
                    coin.symbol = symbol;
                    coin.icon = icon;
                    coin.type = type;
                    coin.path = type === 'BIP39' ? path : null;
                    showToast('‚úÖ –ú–æ–Ω–µ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
                }
            } else {
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ
                const newId = symbol.toLowerCase() + '_' + Date.now();
                coinsRegistry.push({
                    id: newId,
                    name: name,
                    symbol: symbol,
                    icon: icon,
                    type: type,
                    path: type === 'BIP39' ? path : null,
                    active: true
                });
                showToast('‚úÖ –ú–æ–Ω–µ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
            }
            
            closeModal();
            renderCoins();
            updateStats();
        }

        // –°–±—Ä–æ—Å–∏—Ç—å –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        function resetToDefaults() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–µ—Å—Ç—Ä –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º?')) {
                init();
                showToast('üîÑ –†–µ–µ—Å—Ç—Ä —Å–±—Ä–æ—à–µ–Ω');
            }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function updateStats() {
            document.getElementById('totalCoins').textContent = coinsRegistry.length;
            document.getElementById('activeCoins').textContent = coinsRegistry.filter(c => c.active).length;
            document.getElementById('inactiveCoins').textContent = coinsRegistry.filter(c => !c.active).length;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        tg.MainButton.onClick(function() {
            // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –±–æ—Ç—É
            tg.sendData(JSON.stringify({
                coins: coinsRegistry
            }));
        });

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>
