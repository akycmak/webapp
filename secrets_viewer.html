<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            padding: 16px;
            padding-bottom: 80px;
        }

        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--tg-theme-hint-color, #ccc);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999);
        }

        .warning {
            background: #ff9500;
            color: white;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 16px;
            display: flex;
            align-items: start;
            gap: 12px;
        }

        .warning-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .warning-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.5;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--tg-theme-button-color, #3390ec);
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            color: var(--tg-theme-hint-color, #999);
        }

        .filter-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            overflow-x: auto;
        }

        .filter-tab {
            padding: 8px 16px;
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            color: var(--tg-theme-text-color, #000000);
        }

        .filter-tab.active {
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
        }

        .secret-card {
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .secret-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .secret-coin {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            font-weight: 600;
        }

        .secret-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-seed {
            background: #34c759;
            color: white;
        }

        .badge-key {
            background: #ff9500;
            color: white;
        }

        .secret-content {
            background: var(--tg-theme-bg-color, #ffffff);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            position: relative;
        }

        .secret-type {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .secret-value {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            word-break: break-all;
            position: relative;
        }

        .secret-value.hidden {
            filter: blur(8px);
            user-select: none;
        }

        .show-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 8px 16px;
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        .secret-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            flex: 1;
            padding: 10px;
            background: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .action-btn:active {
            opacity: 0.7;
        }

        .action-btn.secondary {
            background: var(--tg-theme-secondary-bg-color, #e0e0e0);
            color: var(--tg-theme-text-color, #000000);
        }

        .secret-meta {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--tg-theme-hint-color, #ddd);
        }

        .meta-item {
            font-size: 12px;
        }

        .meta-label {
            color: var(--tg-theme-hint-color, #999);
            margin-bottom: 2px;
        }

        .meta-value {
            font-weight: 600;
        }

        .empty-state {
            text-align: center;
            padding: 48px 24px;
            color: var(--tg-theme-hint-color, #999);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .export-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .export-btn {
            padding: 12px;
            background: var(--tg-theme-secondary-bg-color, #f5f5f5);
            border: 1px solid var(--tg-theme-hint-color, #ccc);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .export-btn:active {
            opacity: 0.7;
        }

        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 100;
        }

        .toast.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîê –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã</h1>
        <p>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —ç–∫—Å–ø–æ—Ä—Ç</p>
    </div>

    <div class="warning">
        <div class="warning-icon">‚ö†Ô∏è</div>
        <div class="warning-text">
            <strong>–í–∞–∂–Ω–æ!</strong> –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ.
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value" id="totalSecrets">0</div>
            <div class="stat-label">–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="uniqueCoins">0</div>
            <div class="stat-label">–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç</div>
        </div>
    </div>

    <div class="filter-tabs">
        <button class="filter-tab active" onclick="filterSecrets('all')">–í—Å–µ</button>
        <button class="filter-tab" onclick="filterSecrets('seed')">Seed-—Ñ—Ä–∞–∑—ã</button>
        <button class="filter-tab" onclick="filterSecrets('key')">Private Keys</button>
    </div>

    <div class="export-options">
        <button class="export-btn" onclick="exportToTxt()">
            <span>üìÑ</span>
            <span>TXT</span>
        </button>
        <button class="export-btn" onclick="exportToJson()">
            <span>üìã</span>
            <span>JSON</span>
        </button>
        <button class="export-btn" onclick="exportToCsv()">
            <span>üìä</span>
            <span>CSV</span>
        </button>
        <button class="export-btn" onclick="copyAll()">
            <span>üìë</span>
            <span>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ</span>
        </button>
    </div>

    <div id="secretsContainer"></div>

    <div class="toast" id="toast"></div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.BackButton.show();
        tg.BackButton.onClick(() => tg.close());

        // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–¥—É—Ç –æ—Ç –±–æ—Ç–∞)
        let secretsData = {
            archive_id: 123,
            archive_name: 'wallets_backup.zip',
            secrets: [
                {
                    id: 1,
                    coin: 'Bitcoin',
                    symbol: 'BTC',
                    icon: '‚Çø',
                    type: 'seed',
                    value: 'abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about',
                    address: 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh',
                    balance: '0.00',
                    path: "m/84'/0'/0'/0/0"
                },
                {
                    id: 2,
                    coin: 'Ethereum',
                    symbol: 'ETH',
                    icon: 'Œû',
                    type: 'key',
                    value: 'ac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80',
                    address: '0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266',
                    balance: '0.00',
                    path: null
                }
            ]
        };

        // –¢–µ–∫—É—â–∏–π —Ñ–∏–ª—å—Ç—Ä
        let currentFilter = 'all';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–¥—É—Ç —á–µ—Ä–µ–∑ initDataUnsafe
            // const data = tg.initDataUnsafe.start_param;
            // if (data) {
            //     secretsData = JSON.parse(atob(data));
            // }

            renderSecrets();
            updateStats();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
        function renderSecrets() {
            const container = document.getElementById('secretsContainer');
            
            const filteredSecrets = secretsData.secrets.filter(secret => {
                if (currentFilter === 'all') return true;
                return secret.type === currentFilter;
            });

            if (filteredSecrets.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <p>–°–µ–∫—Ä–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredSecrets.map(secret => `
                <div class="secret-card" data-type="${secret.type}">
                    <div class="secret-header">
                        <div class="secret-coin">
                            <span>${secret.icon}</span>
                            <span>${secret.coin}</span>
                        </div>
                        <span class="secret-badge badge-${secret.type}">
                            ${secret.type === 'seed' ? 'Seed-—Ñ—Ä–∞–∑–∞' : 'Private Key'}
                        </span>
                    </div>

                    <div class="secret-content">
                        <div class="secret-type">${secret.type === 'seed' ? '–ú–Ω–µ–º–æ–Ω–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–∑–∞' : '–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á'}</div>
                        <div class="secret-value hidden" id="secret-${secret.id}">
                            ${secret.value}
                        </div>
                        <button class="show-btn" onclick="toggleSecret(${secret.id})">
                            üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å
                        </button>
                    </div>

                    <div class="secret-actions">
                        <button class="action-btn" onclick="copySecret(${secret.id}, '${secret.value}')">
                            üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="action-btn secondary" onclick="shareSecret(${secret.id})">
                            üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                        </button>
                    </div>

                    <div class="secret-meta">
                        <div class="meta-item">
                            <div class="meta-label">–ê–¥—Ä–µ—Å</div>
                            <div class="meta-value">${secret.address.substring(0, 10)}...${secret.address.substring(secret.address.length - 8)}</div>
                        </div>
                        <div class="meta-item">
                            <div class="meta-label">–ë–∞–ª–∞–Ω—Å</div>
                            <div class="meta-value">${secret.balance} ${secret.symbol}</div>
                        </div>
                        ${secret.path ? `
                        <div class="meta-item">
                            <div class="meta-label">–ü—É—Ç—å</div>
                            <div class="meta-value">${secret.path}</div>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å–µ–∫—Ä–µ—Ç
        function toggleSecret(id) {
            const secretElement = document.getElementById(`secret-${id}`);
            const btn = event.target;
            
            if (secretElement.classList.contains('hidden')) {
                secretElement.classList.remove('hidden');
                btn.textContent = 'üôà –°–∫—Ä—ã—Ç—å';
                btn.style.display = 'none';
            } else {
                secretElement.classList.add('hidden');
                btn.textContent = 'üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å';
                btn.style.display = 'block';
            }
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç
        function copySecret(id, value) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(value).then(() => {
                    showToast('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                }).catch(() => {
                    showToast('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è');
                });
            } else {
                // Fallback
                const textarea = document.createElement('textarea');
                textarea.value = value;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToast('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
            }
        }

        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º
        function shareSecret(id) {
            const secret = secretsData.secrets.find(s => s.id === id);
            const text = `${secret.coin} (${secret.symbol})\n${secret.type === 'seed' ? 'Seed-—Ñ—Ä–∞–∑–∞' : 'Private Key'}:\n${secret.value}\n\n–ê–¥—Ä–µ—Å: ${secret.address}`;
            
            if (navigator.share) {
                navigator.share({
                    text: text
                }).catch(() => {});
            } else {
                copySecret(id, text);
            }
        }

        // –§–∏–ª—å—Ç—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤
        function filterSecrets(type) {
            currentFilter = type;
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderSecrets();
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function updateStats() {
            document.getElementById('totalSecrets').textContent = secretsData.secrets.length;
            
            const uniqueCoins = new Set(secretsData.secrets.map(s => s.coin));
            document.getElementById('uniqueCoins').textContent = uniqueCoins.size;
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ TXT
        function exportToTxt() {
            let content = `–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã\n–ê—Ä—Ö–∏–≤: ${secretsData.archive_name}\n\n`;
            
            secretsData.secrets.forEach((secret, index) => {
                content += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                content += `#${index + 1} ${secret.coin} (${secret.symbol})\n`;
                content += `–¢–∏–ø: ${secret.type === 'seed' ? 'Seed-—Ñ—Ä–∞–∑–∞' : 'Private Key'}\n`;
                content += `–ó–Ω–∞—á–µ–Ω–∏–µ: ${secret.value}\n`;
                content += `–ê–¥—Ä–µ—Å: ${secret.address}\n`;
                if (secret.path) content += `–ü—É—Ç—å: ${secret.path}\n`;
                content += `–ë–∞–ª–∞–Ω—Å: ${secret.balance} ${secret.symbol}\n\n`;
            });
            
            downloadFile('secrets.txt', content, 'text/plain');
            showToast('‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ TXT');
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
        function exportToJson() {
            const content = JSON.stringify(secretsData, null, 2);
            downloadFile('secrets.json', content, 'application/json');
            showToast('‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ JSON');
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
        function exportToCsv() {
            let content = 'Coin,Symbol,Type,Value,Address,Balance,Path\n';
            
            secretsData.secrets.forEach(secret => {
                content += `"${secret.coin}","${secret.symbol}","${secret.type}","${secret.value}","${secret.address}","${secret.balance}","${secret.path || ''}"\n`;
            });
            
            downloadFile('secrets.csv', content, 'text/csv');
            showToast('‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ CSV');
        }

        // –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
        function copyAll() {
            let content = '';
            
            secretsData.secrets.forEach(secret => {
                content += `${secret.coin}: ${secret.value}\n`;
            });
            
            copySecret(0, content);
        }

        // –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
        function downloadFile(filename, content, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>
